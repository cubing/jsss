let e="warn";let t=0;function r(r){switch(e){case"error":throw new Error(r);case"warn":return t++,void(t<10&&t+1===10&&console.warn(r))}}function n(t){e=t}class AlgPart{}function a(e,t){return e.type===t}function o(e,t){return a(e,t)||r(`Expected "type": "${t}", saw "type": "${e.type}".`),e}function s(e){return"type"in e&&!a(e,"sequence")}function u(e){return"type"in e||r('Expected "unit", saw a value that was not an AlgPart.'),a(e,"sequence")&&r('Expected unit, saw "sequence".'),e}class Unit extends AlgPart{}class Move extends Unit{}class Annotation extends Unit{}class Container extends Unit{}class Sequence extends AlgPart{constructor(e){super(),this.nestedUnits=e,this.type="sequence";for(const t of e)u(t);Object.freeze(this.nestedUnits),Object.freeze(this)}}class Group extends Container{constructor(e,t=1){super(),this.nestedSequence=e,this.amount=t,this.type="group",Object.freeze(this)}}class Commutator extends Container{constructor(e,t,r=1){super(),this.A=e,this.B=t,this.amount=r,this.type="commutator",Object.freeze(this)}}class Conjugate extends Container{constructor(e,t,r=1){super(),this.A=e,this.B=t,this.amount=r,this.type="conjugate",Object.freeze(this)}}class Pause extends Move{constructor(){super(),this.type="pause",Object.freeze(this)}}class NewLine extends Annotation{constructor(){super(),this.type="newLine",Object.freeze(this)}}class Comment extends Annotation{constructor(e){super(),this.comment=e,this.type="comment",Object.freeze(this)}}class BlockMove extends Move{constructor(e,t,r,n=1){if(super(),this.family=r,this.amount=n,this.type="blockMove",t&&(this.innerLayer=t,e&&(this.outerLayer=e)),e&&!t)throw new Error("Attempted to contruct block move with outer layer but no inner layer");Object.freeze(this)}}function i(e,t){return new BlockMove(void 0,void 0,e,t)}function c(e,t,r){return new BlockMove(void 0,e,t,r)}function l(e,t,r,n){return new BlockMove(e,t,r,n)}function v(e,t){var r,n,a,o;return new BlockMove(null!==(r=t.outerLayer)&&void 0!==r?r:e.outerLayer,null!==(n=t.innerLayer)&&void 0!==n?n:e.innerLayer,null!==(a=t.family)&&void 0!==a?a:e.family,null!==(o=t.amount)&&void 0!==o?o:e.amount)}function m(e,t,r=!1,n=0){const a=e.nestedUnits,o=a[a.length-1];if(r&&o&&(u=t,(s=o).family===u.family&&s.innerLayer===u.innerLayer&&s.outerLayer===u.outerLayer)){const r=e.nestedUnits.slice(0,a.length-1);let s=o.amount+t.amount;return n>1&&(s=(s%n+n)%n,2*s>n&&(s-=n)),0!==s&&r.push(v(o,{amount:s})),new Sequence(r)}return new Sequence([...a,t]);var s,u}function w(...e){return new Sequence(Array.prototype.concat.apply([],[...e].map(e=>e.nestedUnits)))}function h(e,t,r){switch(t.type){case"sequence":return o(t,"sequence"),e.traverseSequence(t,r);case"group":return o(t,"group"),e.traverseGroup(t,r);case"blockMove":return o(t,"blockMove"),e.traverseBlockMove(t,r);case"commutator":return o(t,"commutator"),e.traverseCommutator(t,r);case"conjugate":return o(t,"conjugate"),e.traverseConjugate(t,r);case"pause":return o(t,"pause"),e.traversePause(t,r);case"newLine":return o(t,"newLine"),e.traverseNewLine(t,r);case"comment":return o(t,"comment"),e.traverseComment(t,r);default:throw new Error(`Unknown AlgPart type: ${t.type}`)}}class TraversalDownUp{traverse(e,t){return h(this,e,t)}traverseIntoUnit(e,t){return u(this.traverse(e,t))}}class TraversalUp extends TraversalDownUp{traverse(e){return h(this,e,void 0)}traverseIntoUnit(e){return u(this.traverse(e))}}function f(e){const t=Math.abs(e);let r="";return 1!==t&&(r+=String(t)),t!==e&&(r+="'"),r}function p(e){let t=e.family+f(e.amount);return void 0!==e.innerLayer&&(t=String(e.innerLayer)+t,void 0!==e.outerLayer&&(t=String(e.outerLayer)+"-"+t)),t}const d=new class Invert extends TraversalUp{traverseSequence(e){return new Sequence(e.nestedUnits.slice().reverse().map(e=>this.traverseIntoUnit(e)))}traverseGroup(e){return new Group(this.traverseSequence(e.nestedSequence),e.amount)}traverseBlockMove(e){return new BlockMove(e.outerLayer,e.innerLayer,e.family,-e.amount)}traverseCommutator(e){return new Commutator(e.B,e.A,e.amount)}traverseConjugate(e){return new Conjugate(e.A,this.traverseSequence(e.B),e.amount)}traversePause(e){return e}traverseNewLine(e){return e}traverseComment(e){return e}},g=new class Expand extends TraversalUp{traverseSequence(e){return new Sequence(this.flattenSequenceOneLevel(e.nestedUnits.map(e=>this.traverse(e))))}traverseGroup(e){return this.repeat(this.flattenSequenceOneLevel([this.traverse(e.nestedSequence)]),e)}traverseBlockMove(e){return e}traverseCommutator(e){const t=this.traverseSequence(e.A),r=this.traverseSequence(e.B);let n=[];return n=n.concat(t,r,A(t),A(r)),this.repeat(this.flattenSequenceOneLevel(n),e)}traverseConjugate(e){const t=this.traverseSequence(e.A),r=this.traverseSequence(e.B);let n=[];return n=n.concat(t,r,A(t)),this.repeat(this.flattenSequenceOneLevel(n),e)}traversePause(e){return e}traverseNewLine(e){return e}traverseComment(e){return e}flattenSequenceOneLevel(e){let t=[];for(const r of e)if(a(r,"sequence"))t=t.concat(r.nestedUnits);else{if(!s(r))throw new Error("expand() encountered an internal error. Did you pass in a valid Algorithm?");t.push(r)}return t}repeat(e,t){const r=Math.abs(t.amount);let n;n=-1===(t.amount>0?1:-1)?A(new Sequence(e)).nestedUnits:e;let a=[];for(let e=0;e<r;e++)a=a.concat(n);return new Sequence(a)}},y=new class StructureEquals extends TraversalDownUp{traverseSequence(e,t){if(s(t))return!1;const r=t;if(e.nestedUnits.length!==r.nestedUnits.length)return!1;for(let t=0;t<e.nestedUnits.length;t++)if(!this.traverse(e.nestedUnits[t],r.nestedUnits[t]))return!1;return!0}traverseGroup(e,t){return a(t,"group")&&this.traverse(e.nestedSequence,t.nestedSequence)}traverseBlockMove(e,t){return a(t,"blockMove")&&e.outerLayer===t.outerLayer&&e.innerLayer===t.innerLayer&&e.family===t.family&&e.amount===t.amount}traverseCommutator(e,t){return a(t,"commutator")&&this.traverse(e.A,t.A)&&this.traverse(e.B,t.B)}traverseConjugate(e,t){return a(t,"conjugate")&&this.traverse(e.A,t.A)&&this.traverse(e.B,t.B)}traversePause(e,t){return a(t,"pause")}traverseNewLine(e,t){return a(t,"newLine")}traverseComment(e,t){return a(t,"comment")&&e.comment===t.comment}},S=new class CoalesceBaseMoves extends TraversalUp{traverseSequence(e){const t=[];for(const r of e.nestedUnits)if(a(r,"blockMove"))if(t.length>0){const e=t[t.length-1];if(a(e,"blockMove")&&this.sameBlock(e,r)){const n=e.amount+r.amount;t.pop(),0!==n&&t.push(new BlockMove(r.outerLayer,r.innerLayer,r.family,n))}else t.push(r)}else t.push(r);else t.push(this.traverseIntoUnit(r));return new Sequence(t)}traverseGroup(e){return e}traverseBlockMove(e){return e}traverseCommutator(e){return e}traverseConjugate(e){return e}traversePause(e){return e}traverseNewLine(e){return e}traverseComment(e){return e}sameBlock(e,t){return e.outerLayer===t.outerLayer&&e.innerLayer===t.innerLayer&&e.family===t.family}},q=new class ToString extends TraversalUp{traverseSequence(e){let t="";if(e.nestedUnits.length>0){t+=this.traverse(e.nestedUnits[0]);for(let r=1;r<e.nestedUnits.length;r++)t+=this.spaceBetween(e.nestedUnits[r-1],e.nestedUnits[r]),t+=this.traverse(e.nestedUnits[r])}return t}traverseGroup(e){return"("+this.traverse(e.nestedSequence)+")"+f(e.amount)}traverseBlockMove(e){return p(e)}traverseCommutator(e){return"["+this.traverse(e.A)+", "+this.traverse(e.B)+"]"+f(e.amount)}traverseConjugate(e){return"["+this.traverse(e.A)+": "+this.traverse(e.B)+"]"+f(e.amount)}traversePause(e){return"."}traverseNewLine(e){return"\n"}traverseComment(e){return"//"+e.comment}spaceBetween(e,t){return a(e,"pause")&&a(t,"pause")||a(e,"newLine")||a(t,"newLine")?"":a(e,"comment")&&!a(t,"newLine")?"\n":" "}},A=d.traverseSequence.bind(d),x=g.traverseSequence.bind(g),L=y.traverseSequence.bind(y),U=S.traverseSequence.bind(S),C=q.traverseSequence.bind(q),M=(q.traverse.bind(q),q.traverse.bind(q));function B(e){return M(new BlockMove(e.outerLayer,e.innerLayer,e.family,1))}var E;function R(e){if("sequence"!==e.type)throw new Error(`Expected Sequence while parsing, got: ${e.type}`);if(!e.nestedUnits)throw new Error("Missing nestedUnits");return new Sequence(e.nestedUnits.map(e=>function(e){switch(e.type){case"sequence":throw new Error("Expected AlgPart while parsing, got `Sequence`.");case"group":if(!e.nestedSequence)throw new Error("Missing nestedSequence");if(!e.amount)throw new Error("Missing amount");return new Group(R(e.nestedSequence),e.amount);case"blockMove":if(!e.family)throw new Error("Missing family");if(!e.amount)throw new Error("Missing amount");return new BlockMove(e.outerLayer,e.innerLayer,e.family,e.amount);case"commutator":if(!e.A)throw new Error("Missing A");if(!e.B)throw new Error("Missing B");if(!e.amount)throw new Error("Missing amount");return new Commutator(R(e.A),R(e.B),e.amount);case"conjugate":if(!e.A)throw new Error("Missing A");if(!e.B)throw new Error("Missing B");if(!e.amount)throw new Error("Missing amount");return new Conjugate(R(e.A),R(e.B),e.amount);case"pause":return new Pause;case"newLine":return new NewLine;case"comment":if(!e.comment&&""!==e.comment)throw new Error("Missing comment");return new Comment(e.comment);default:throw new Error(`Unknown alg type: ${e.type}`)}}(e)))}!function(e){e.Sune=new Sequence([i("R",1),i("U",1),i("R",-1),i("U",1),i("R",1),i("U",-2),i("R",-1)]),e.AntiSune=new Sequence([i("R",1),i("U",2),i("R",-1),i("U",-1),i("R",1),i("U",-1),i("R",-1)]),e.SuneCommutator=new Sequence([new Commutator(new Sequence([i("R",1),i("U",1),i("R",-2)]),new Sequence([new Conjugate(new Sequence([i("R",1)]),new Sequence([i("U",1)]),1)]),1)]),e.Niklas=new Sequence([i("R",1),i("U",-1),i("L",-1),i("U",1),i("R",-1),i("U",-1),i("L",1),i("U",1)]),e.EPerm=new Sequence([i("x",-1),new Commutator(new Sequence([new Conjugate(new Sequence([i("R",1)]),new Sequence([i("U",-1)]))]),new Sequence([i("D",1)]),1),new Commutator(new Sequence([new Conjugate(new Sequence([i("R",1)]),new Sequence([i("U",1)]))]),new Sequence([i("D",1)]),1),i("x",1)]),e.FURURFCompact=new Sequence([new Conjugate(new Sequence([i("F",1)]),new Sequence([new Commutator(new Sequence([i("U",1)]),new Sequence([i("R",1)]),1)]),1)]),e.APermCompact=new Sequence([new Conjugate(new Sequence([i("R",2)]),new Sequence([new Commutator(new Sequence([i("F",2)]),new Sequence([i("R",-1),i("B",-1),i("R",1)]),1)]),1)]),e.FURURFMoves=new Sequence([i("F",1),i("U",1),i("R",1),i("U",-1),i("R",-1),i("F",-1)]),e.TPerm=new Sequence([i("R",1),i("U",1),i("R",-1),i("U",-1),i("R",-1),i("F",1),i("R",2),i("U",-1),i("R",-1),i("U",-1),i("R",1),i("U",1),i("R",-1),i("F",-1)]),e.HeadlightSwaps=new Sequence([new Conjugate(new Sequence([i("F",1)]),new Sequence([new Commutator(new Sequence([i("R",1)]),new Sequence([i("U",1)]),3)]),1)]),e.TriplePause=new Sequence([new Pause,new Pause,new Pause]),e.AllAlgParts=[new Sequence([i("R",1),i("U",-1)]),new Group(new Sequence([i("F",1)]),2),i("R",2),new Commutator(new Sequence([i("R",2)]),new Sequence([i("U",2)]),2),new Conjugate(new Sequence([i("L",2)]),new Sequence([i("D",-1)]),2),new Pause,new NewLine,new Comment("short comment")]}(E||(E={}));class ValidationError extends Error{}class ValidatorTraversal extends TraversalUp{}function k(e,t){for(const r of t)if(!0===r[e])return!0;return!1}const b={x:!0,y:!0,z:!0,M:!0,E:!0,S:!0,m:!0,e:!0,s:!0},P={U:!0,L:!0,F:!0,R:!0,B:!0,D:!0},j={u:!0,l:!0,f:!0,r:!0,b:!0,d:!0,Uw:!0,Lw:!0,Fw:!0,Rw:!0,Bw:!0,Dw:!0};class BaseMoveValidator extends ValidatorTraversal{traverseSequence(e){for(const t of e.nestedUnits)this.traverse(t)}traverseGroup(e){return this.traverse(e.nestedSequence)}traverseCommutator(e){this.traverse(e.A),this.traverse(e.B)}traverseConjugate(e){this.traverse(e.A),this.traverse(e.B)}traversePause(e){}traverseNewLine(e){}traverseComment(e){}}const T=new class BlockMoveValidator extends BaseMoveValidator{traverseBlockMove(e){if(void 0===e.outerLayer)if(void 0===e.innerLayer){if(!k(e.family,[j,P,b]))throw new ValidationError(`Invalid SiGN plain move family: ${e.family}`)}else{if(!k(e.family,[j,P]))throw new ValidationError(`The provided SiGN move family is invalid, or cannot have an inner slice: ${e.family}`);if(e.innerLayer<=0)throw new ValidationError("Cannot have an inner layer of 0 or less.")}else{if(void 0===e.innerLayer)throw new ValidationError("A BlockMove with an outer layer must have an inner layer.");if(!k(e.family,[j]))throw new ValidationError(`The provided SiGN move family is invalid, or cannot have an outer and inner layer: ${e.family}`);if(e.outerLayer<=0)throw new ValidationError("Cannot have an outer layer of 0 or less.");if(e.outerLayer>=e.innerLayer)throw new ValidationError("The outer layer must be less than the inner layer.")}}},F=T.traverse.bind(T),z=new class FlatAlgValidator extends ValidatorTraversal{traverseSequence(e){for(const t of e.nestedUnits)this.traverse(t)}traverseGroup(e){throw new ValidationError("A flat alg cannot contain a group.")}traverseBlockMove(e){}traverseCommutator(e){throw new ValidationError("A flat alg cannot contain a commutator.")}traverseConjugate(e){throw new ValidationError("A flat alg cannot contain a conjugate.")}traversePause(e){}traverseNewLine(e){}traverseComment(e){}},N=z.traverse.bind(z);function V(e){F(e),N(e)}var G=function(){function e(t,r,n,a){this.message=t,this.expected=r,this.found=n,this.location=a,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r={literal:function(e){return'"'+a(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?o(e.parts[t][0])+"-"+o(e.parts[t][1]):o(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function a(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,a,o=new Array(e.length);for(t=0;t<e.length;t++)o[t]=(a=e[t],r[a.type](a));if(o.sort(),o.length>0){for(t=1,n=1;t<o.length;t++)o[t-1]!==o[t]&&(o[n]=o[t],n++);o.length=n}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(e)+" but "+function(e){return e?'"'+a(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,a,o,s,u={},i={start:V},c=V,l=/^[0-9]/,v=T([["0","9"]],!1,!1),m=j("'",!1),w=/^[_A-Za-z]/,h=T(["_",["A","Z"],["a","z"]],!1,!1),f=j("-",!1),p=j("[",!1),d=/^[,:]/,g=T([",",":"],!1,!1),y=j("]",!1),S=j("(",!1),q=j(")",!1),A=j("//",!1),x=/^[^\n\r]/,L=T(["\n","\r"],!0,!1),U=/^[\n\r]/,C=T(["\n","\r"],!1,!1),M=j(".",!1),B=/^[ ]/,E=T([" "],!1,!1),R=0,k=[{line:1,column:1}],b=0,P=[];if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');c=i[r.startRule]}function j(e,t){return{type:"literal",text:e,ignoreCase:t}}function T(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function F(e){var r,n=k[e];if(n)return n;for(r=e-1;!k[r];)r--;for(n={line:(n=k[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return k[e]=n,n}function z(e,t){var r=F(e),n=F(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function N(e){R<b||(R>b&&(b=R,P=[]),P.push(e))}function V(){return H()}function G(){var e,r;if(R,e=[],l.test(t.charAt(R))?(r=t.charAt(R),R++):(r=u,N(v)),r!==u)for(;r!==u;)e.push(r),l.test(t.charAt(R))?(r=t.charAt(R),R++):(r=u,N(v));else e=u;return e!==u&&(e=parseInt(e.join(""),10)),e}function O(){var e,r;if(R,e=[],w.test(t.charAt(R))?(r=t.charAt(R),R++):(r=u,N(h)),r!==u)for(;r!==u;)e.push(r),w.test(t.charAt(R))?(r=t.charAt(R),R++):(r=u,N(h));else e=u;return e!==u&&(e=e.join("")),e}function D(){var e,r,n,a,o,s;return(e=function(){var e,r,n,a,o;return e=R,(r=O())!==u&&(r={type:"blockMove",family:r}),(e=r)===u&&(e=R,(r=G())!==u&&(n=O())!==u?e=r=function(e,t){return{type:"blockMove",family:t,innerLayer:e}}(r,n):(R=e,e=u),e===u&&(e=R,(r=G())!==u?(45===t.charCodeAt(R)?(n="-",R++):(n=u,N(f)),n!==u&&(a=G())!==u&&(o=O())!==u?e=r=function(e,t,r){return{type:"blockMove",family:r,outerLayer:e,innerLayer:t}}(r,a,o):(R=e,e=u)):(R=e,e=u))),e}())===u&&(e=R,91===t.charCodeAt(R)?(r="[",R++):(r=u,N(p)),r!==u&&(n=H())!==u?(d.test(t.charAt(R))?(a=t.charAt(R),R++):(a=u,N(g)),a!==u&&(o=H())!==u?(93===t.charCodeAt(R)?(s="]",R++):(s=u,N(y)),s!==u?e=r={type:","===a?"commutator":"conjugate",A:n,B:o}:(R=e,e=u)):(R=e,e=u)):(R=e,e=u),e===u&&(e=R,40===t.charCodeAt(R)?(r="(",R++):(r=u,N(S)),r!==u&&(n=H())!==u?(41===t.charCodeAt(R)?(a=")",R++):(a=u,N(q)),a!==u?e=r={type:"group",nestedSequence:n}:(R=e,e=u)):(R=e,e=u))),e}function $(){var e,r,n,a,o;return e=R,(r=D())!==u&&(n=function(){var e,r,n;return e=R,(r=G())!==u?(39===t.charCodeAt(R)?(n="'",R++):(n=u,N(m)),n!==u?e=r=-r:(R=e,e=u)):(R=e,e=u),e===u&&(e=G())===u&&(e=R,39===t.charCodeAt(R)?(r="'",R++):(r=u,N(m)),r!==u&&(r=-1),e=r),e}())!==u?(o=n,(a=r).amount=o,e=r=a):(R=e,e=u),e===u&&(e=R,(r=D())!==u&&(r=function(e){return e.amount=1,e}(r)),e=r),e}function I(){var e,r;return e=R,U.test(t.charAt(R))?(r=t.charAt(R),R++):(r=u,N(C)),r!==u&&(r={type:"newLine"}),(e=r)===u&&(e=R,46===t.charCodeAt(R)?(r=".",R++):(r=u,N(M)),r!==u&&(r={type:"pause"}),(e=r)===u&&(e=function(){var e,r,n,a;if(e=R,"//"===t.substr(R,2)?(r="//",R+=2):(r=u,N(A)),r!==u){for(n=[],x.test(t.charAt(R))?(a=t.charAt(R),R++):(a=u,N(L));a!==u;)n.push(a),x.test(t.charAt(R))?(a=t.charAt(R),R++):(a=u,N(L));n!==u?e=r={type:"comment",comment:n.join("")}:(R=e,e=u)}else R=e,e=u;return e}())),e}function _(){var e;return(e=$())===u&&(e=I()),e}function Z(){var e,t,r;return e=R,(t=_())!==u&&(r=Z())!==u?e=t=[t].concat(r):(R=e,e=u),e===u&&(e=R,(t=_())!==u&&(t=function(e){return[e]}(t)),e=t),e}function H(){var e,r,n,a,o;for(e=R,r=[],B.test(t.charAt(R))?(n=t.charAt(R),R++):(n=u,N(E));n!==u;)r.push(n),B.test(t.charAt(R))?(n=t.charAt(R),R++):(n=u,N(E));if(r!==u)if((n=function e(){var r,n,a,o,s;if(r=R,(n=Z())!==u){if(a=[],B.test(t.charAt(R))?(o=t.charAt(R),R++):(o=u,N(E)),o!==u)for(;o!==u;)a.push(o),B.test(t.charAt(R))?(o=t.charAt(R),R++):(o=u,N(E));else a=u;a!==u&&(o=e())!==u?(s=o,r=n=n.concat(s)):(R=r,r=u)}else R=r,r=u;return r===u&&(r=Z()),r}())!==u){for(a=[],B.test(t.charAt(R))?(o=t.charAt(R),R++):(o=u,N(E));o!==u;)a.push(o),B.test(t.charAt(R))?(o=t.charAt(R),R++):(o=u,N(E));a!==u?e=r={type:"sequence",nestedUnits:n}:(R=e,e=u)}else R=e,e=u;else R=e,e=u;if(e===u){for(e=R,r=[],B.test(t.charAt(R))?(n=t.charAt(R),R++):(n=u,N(E));n!==u;)r.push(n),B.test(t.charAt(R))?(n=t.charAt(R),R++):(n=u,N(E));r!==u&&(r={type:"sequence",nestedUnits:[]}),e=r}return e}if((n=c())!==u&&R===t.length)return n;throw n!==u&&R<t.length&&N({type:"end"}),a=P,o=b<t.length?t.charAt(b):null,s=b<t.length?z(b,b+1):z(b,b),new e(e.buildMessage(a,o),a,o,s)}}}();const{parse:O}=G;function D(e,t={validators:[]}){t.validators=t.validators||[];const r=R(O(e));for(const e of t.validators)e(r);return r}const $={73:i("R"),75:i("R",-1),87:i("B"),79:i("B",-1),83:i("D"),76:i("D",-1),68:i("L"),69:i("L",-1),74:i("U"),70:i("U",-1),72:i("F"),71:i("F",-1),78:i("F"),86:i("F",-1),67:i("l"),82:i("l",-1),85:i("r"),77:i("r",-1),84:i("x"),89:i("x"),66:i("x",-1),186:i("y"),59:i("y"),65:i("y",-1),80:i("z"),81:i("z",-1),190:i("M",-1)};function I(e){return e.altKey||e.ctrlKey?null:$[e.keyCode]||null}function _(e){let t=C(e);return t=t.replace(/_/g,"&#95;").replace(/ /g,"_"),t=t.replace(/\+/g,"&#2b;"),t=t.replace(/-/g,"&#45;").replace(/'/g,"-"),t}function Z(e){let t=e;return t=t.replace(/-/g,"'").replace(/&#45;/g,"-"),t=t.replace(/\+/g," ").replace(/&#2b;/g,"+"),t=t.replace(/_/g," ").replace(/&#95;/g,"_"),D(t)}function H(e){return Z(new URLSearchParams(window.location.search).get(e)||"")}function K(e){const t=new URL("https://alg.cubing.net");if(!e.alg)throw new Error("An alg parameter is required.");if(t.searchParams.set("alg",_(e.alg)),e.setup&&t.searchParams.set("setup",_(e.setup)),e.title&&t.searchParams.set("title",e.title),e.puzzle){if(-1===["1x1x1","2x2x2","3x3x3","4x4x4","5x5x5","6x6x6","7x7x7","8x8x8","9x9x9","10x10x10","11x11x11","12x12x12","13x13x13","14x14x14","16x16x16","17x17x17"].indexOf(e.puzzle))throw new Error(`Invalid puzzle parameter: ${e.puzzle}`);t.searchParams.set("puzzle",e.puzzle)}if(e.stage){if(-1===["full","cross","F2L","LL","OLL","PLL","CLS","ELS","L6E","CMLL","WV","ZBLL","void"].indexOf(e.stage))throw new Error(`Invalid stage parameter: ${e.stage}`);t.searchParams.set("stage",e.stage)}if(e.view){if(-1===["editor","playback","fullscreen"].indexOf(e.view))throw new Error(`Invalid view parameter: ${e.view}`);t.searchParams.set("view",e.view)}if(e.type){if(-1===["moves","reconstruction","alg","reconstruction-end-with-setup"].indexOf(e.type))throw new Error(`Invalid type parameter: ${e.type}`);t.searchParams.set("type",e.type)}return t.toString()}var J=Object.freeze({__proto__:null,AlgPart:AlgPart,Unit:Unit,Move:Move,Container:Container,Annotation:Annotation,Sequence:Sequence,Group:Group,BlockMove:BlockMove,BareBlockMove:i,LayerBlockMove:c,RangeBlockMove:l,Commutator:Commutator,Conjugate:Conjugate,Pause:Pause,NewLine:NewLine,Comment:Comment,modifiedBlockMove:v,experimentalAppendBlockMove:m,experimentalConcatAlgs:w,TraversalDownUp:TraversalDownUp,TraversalUp:TraversalUp,invert:A,expand:x,structureEquals:L,coalesceBaseMoves:U,algToString:C,algPartToStringForTesting:M,blockMoveToString:p,get Example(){return E},fromJSON:R,parse:D,keyToMove:I,validateSiGNMoves:F,validateFlatAlg:N,validateSiGNAlg:V,ValidationError:ValidationError,serializeURLParam:_,deserializeURLParam:Z,algCubingNetLink:K,getAlgURLParam:H,setAlgPartTypeMismatchReportingLevel:n});export{AlgPart as A,BlockMove as B,Container as C,n as D,E,B as F,Group as G,J as H,c as L,Move as M,NewLine as N,Pause as P,l as R,Sequence as S,TraversalDownUp as T,Unit as U,ValidationError as V,Annotation as a,i as b,Commutator as c,Conjugate as d,Comment as e,m as f,w as g,TraversalUp as h,A as i,x as j,U as k,C as l,v as m,M as n,p as o,R as p,D as q,I as r,L as s,N as t,V as u,F as v,_ as w,Z as x,K as y,H as z};
//# sourceMappingURL=index-03ee41f0.js.map
